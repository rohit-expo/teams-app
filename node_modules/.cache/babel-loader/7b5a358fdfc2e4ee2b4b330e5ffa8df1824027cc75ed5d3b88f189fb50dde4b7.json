{"ast":null,"code":"import { useIsomorphicLayoutEffect } from '@fluentui/react-utilities';\nimport * as React from 'react';\n/**\n * @internal\n * This hook returns context selected value by selector.\n * It will only accept context created by `createContext`.\n * It will trigger re-render if only the selected value is referencially changed.\n */\n\nexport const useContextSelector = (context, selector) => {\n  const contextValue = React.useContext(context);\n  const {\n    value: {\n      current: value\n    },\n    version: {\n      current: version\n    },\n    listeners\n  } = contextValue;\n  const selected = selector(value);\n  const [state, dispatch] = React.useReducer((prevState, payload) => {\n    if (!payload) {\n      // early bail out when is dispatched during render\n      return [value, selected];\n    }\n    if (payload[0] <= version) {\n      if (objectIs(prevState[1], selected)) {\n        return prevState; // bail out\n      }\n\n      return [value, selected];\n    }\n    try {\n      if (objectIs(prevState[0], payload[1])) {\n        return prevState; // do not update\n      }\n\n      const nextSelected = selector(payload[1]);\n      if (objectIs(prevState[1], nextSelected)) {\n        return prevState; // do not update\n      }\n\n      return [payload[1], nextSelected];\n    } catch (e) {// ignored (stale props or some other reason)\n    } // explicitly spread to enforce typing\n\n    return [prevState[0], prevState[1]]; // schedule update\n  }, [value, selected]);\n  if (!objectIs(state[1], selected)) {\n    // schedule re-render\n    // this is safe because it's self contained\n    dispatch(undefined);\n  }\n  useIsomorphicLayoutEffect(() => {\n    listeners.push(dispatch);\n    return () => {\n      const index = listeners.indexOf(dispatch);\n      listeners.splice(index, 1);\n    };\n  }, [listeners]);\n  return state[1];\n};\n/**\n * inlined Object.is polyfill to avoid requiring consumers ship their own\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nfunction is(x, y) {\n  return x === y && (x !== 0 || 1 / x === 1 / y) || x !== x && y !== y // eslint-disable-line no-self-compare\n  ;\n} // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nconst objectIs =\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore fallback to native if it exists (not in IE11)\ntypeof Object.is === 'function' ? Object.is : is;","map":{"version":3,"mappings":"AAAA,SAASA,yBAAT,QAA0C,2BAA1C;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AAaA;;;;;AAKG;;AACH,OAAO,MAAMC,kBAAkB,GAAG,CAChCC,OADgC,EAEhCC,QAFgC,KAGf;EACjB,MAAMC,YAAY,GAAGJ,KAAK,CAACK,UAAN,CAAkBH,OAAlB,CAArB;EAEA,MAAM;IACJI,KAAK,EAAE;MAAEC,OAAO,EAAED;IAAX,CADH;IAEJE,OAAO,EAAE;MAAED,OAAO,EAAEC;IAAX,CAFL;IAGJC;EAHI,IAIFL,YAJJ;EAKA,MAAMM,QAAQ,GAAGP,QAAQ,CAACG,KAAD,CAAzB;EAEA,MAAM,CAACK,KAAD,EAAQC,QAAR,IAAoBZ,KAAK,CAACa,UAAN,CACxB,CACEC,SADF,EAEEC,OAFF,KAKqC;IACnC,IAAI,CAACA,OAAL,EAAc;MACZ;MACA,OAAO,CAACT,KAAD,EAAQI,QAAR,CAAP;IACD;IAED,IAAIK,OAAO,CAAC,CAAD,CAAP,IAAcP,OAAlB,EAA2B;MACzB,IAAIQ,QAAQ,CAACF,SAAS,CAAC,CAAD,CAAV,EAAeJ,QAAf,CAAZ,EAAsC;QACpC,OAAOI,SAAP,CADoC,CAClB;MACnB;;MAED,OAAO,CAACR,KAAD,EAAQI,QAAR,CAAP;IACD;IAED,IAAI;MACF,IAAIM,QAAQ,CAACF,SAAS,CAAC,CAAD,CAAV,EAAeC,OAAO,CAAC,CAAD,CAAtB,CAAZ,EAAwC;QACtC,OAAOD,SAAP,CADsC,CACpB;MACnB;;MAED,MAAMG,YAAY,GAAGd,QAAQ,CAACY,OAAO,CAAC,CAAD,CAAR,CAA7B;MAEA,IAAIC,QAAQ,CAACF,SAAS,CAAC,CAAD,CAAV,EAAeG,YAAf,CAAZ,EAA0C;QACxC,OAAOH,SAAP,CADwC,CACtB;MACnB;;MAED,OAAO,CAACC,OAAO,CAAC,CAAD,CAAR,EAAaE,YAAb,CAAP;IACD,CAZD,CAYE,OAAOC,CAAP,EAAU,CACV;IAAA,CA3BiC,CA8BnC;;IACA,OAAO,CAACJ,SAAS,CAAC,CAAD,CAAV,EAAeA,SAAS,CAAC,CAAD,CAAxB,CAAP,CA/BmC,CA+BW;EAC/C,CAtCuB,EAuCxB,CAACR,KAAD,EAAQI,QAAR,CAvCwB,CAA1B;EA0CA,IAAI,CAACM,QAAQ,CAACL,KAAK,CAAC,CAAD,CAAN,EAAWD,QAAX,CAAb,EAAmC;IACjC;IACA;IACAE,QAAQ,CAACO,SAAD,CAAR;EACD;EAEDpB,yBAAyB,CAAC,MAAK;IAC7BU,SAAS,CAACW,IAAV,CAAeR,QAAf;IAEA,OAAO,MAAK;MACV,MAAMS,KAAK,GAAGZ,SAAS,CAACa,OAAV,CAAkBV,QAAlB,CAAd;MACAH,SAAS,CAACc,MAAV,CAAiBF,KAAjB,EAAwB,CAAxB;IACD,CAHD;EAID,CAPwB,EAOtB,CAACZ,SAAD,CAPsB,CAAzB;EASA,OAAOE,KAAK,CAAC,CAAD,CAAZ;AACD,CAvEM;AAyEP;;;AAGG;AACH;;AACA,SAASa,EAAT,CAAYC,CAAZ,EAAoBC,CAApB,EAA0B;EACxB,OACGD,CAAC,KAAKC,CAAN,KAAYD,CAAC,KAAK,CAAN,IAAW,IAAIA,CAAJ,KAAU,IAAIC,CAArC,CAAD,IAA8CD,CAAC,KAAKA,CAAN,IAAWC,CAAC,KAAKA,CADjE,CACoE;EAAA;AAErE,C,CAED;;AACA,MAAMV,QAAQ;AACZ;AACA;AACA,OAAOW,MAAM,CAACH,EAAd,KAAqB,UAArB,GAAkCG,MAAM,CAACH,EAAzC,GAA8CA,EAHhD","names":["useIsomorphicLayoutEffect","React","useContextSelector","context","selector","contextValue","useContext","value","current","version","listeners","selected","state","dispatch","useReducer","prevState","payload","objectIs","nextSelected","e","undefined","push","index","indexOf","splice","is","x","y","Object"],"sources":["D:\\teams-app\\qlik2\\Microsoft-Teams-Samples\\samples\\tab-personal-sso-quickstart\\js\\node_modules\\@fluentui\\react-context-selector\\src\\packages\\react-components\\react-context-selector\\src\\useContextSelector.ts"],"sourcesContent":["import { useIsomorphicLayoutEffect } from '@fluentui/react-utilities';\nimport * as React from 'react';\n\nimport { Context, ContextSelector, ContextValue, ContextVersion } from './types';\n\n/**\n * Narrowing React.Reducer type to be more easily usable below.\n * No need to export this as it's for internal reducer usage.\n */\ntype ContextReducer<Value, SelectedValue> = React.Reducer<\n  readonly [Value, SelectedValue],\n  undefined | readonly [ContextVersion, Value]\n>;\n\n/**\n * @internal\n * This hook returns context selected value by selector.\n * It will only accept context created by `createContext`.\n * It will trigger re-render if only the selected value is referencially changed.\n */\nexport const useContextSelector = <Value, SelectedValue>(\n  context: Context<Value>,\n  selector: ContextSelector<Value, SelectedValue>,\n): SelectedValue => {\n  const contextValue = React.useContext((context as unknown) as Context<ContextValue<Value>>);\n\n  const {\n    value: { current: value },\n    version: { current: version },\n    listeners,\n  } = contextValue;\n  const selected = selector(value);\n\n  const [state, dispatch] = React.useReducer<ContextReducer<Value, SelectedValue>>(\n    (\n      prevState: readonly [Value /* contextValue */, SelectedValue /* selector(value) */],\n      payload:\n        | undefined // undefined from render below\n        | readonly [ContextVersion, Value], // from provider effect\n    ): readonly [Value, SelectedValue] => {\n      if (!payload) {\n        // early bail out when is dispatched during render\n        return [value, selected] as const;\n      }\n\n      if (payload[0] <= version) {\n        if (objectIs(prevState[1], selected)) {\n          return prevState; // bail out\n        }\n\n        return [value, selected] as const;\n      }\n\n      try {\n        if (objectIs(prevState[0], payload[1])) {\n          return prevState; // do not update\n        }\n\n        const nextSelected = selector(payload[1]);\n\n        if (objectIs(prevState[1], nextSelected)) {\n          return prevState; // do not update\n        }\n\n        return [payload[1], nextSelected] as const;\n      } catch (e) {\n        // ignored (stale props or some other reason)\n      }\n\n      // explicitly spread to enforce typing\n      return [prevState[0], prevState[1]] as const; // schedule update\n    },\n    [value, selected] as const,\n  );\n\n  if (!objectIs(state[1], selected)) {\n    // schedule re-render\n    // this is safe because it's self contained\n    dispatch(undefined);\n  }\n\n  useIsomorphicLayoutEffect(() => {\n    listeners.push(dispatch);\n\n    return () => {\n      const index = listeners.indexOf(dispatch);\n      listeners.splice(index, 1);\n    };\n  }, [listeners]);\n\n  return state[1] as SelectedValue;\n};\n\n/**\n * inlined Object.is polyfill to avoid requiring consumers ship their own\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction is(x: any, y: any) {\n  return (\n    (x === y && (x !== 0 || 1 / x === 1 / y)) || (x !== x && y !== y) // eslint-disable-line no-self-compare\n  );\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst objectIs: (x: any, y: any) => boolean =\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore fallback to native if it exists (not in IE11)\n  typeof Object.is === 'function' ? Object.is : is;\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}